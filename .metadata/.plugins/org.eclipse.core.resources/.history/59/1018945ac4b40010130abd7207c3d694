/*
 * Gps.h
 *
 *  Created on: Jun 29, 2024
 *      Author: onurd
 */

#ifndef MYOTONOMDRIVERS_INC_GPS_H_
#define MYOTONOMDRIVERS_INC_GPS_H_

#include "main.h"
#include "lwgps/lwgps.h"

class GPS {

public:
    GPS(UART_HandleTypeDef* huart);
    void Yapilandir();
    void DataOku();
    float* LatitudeAl();
    float* LongitudeAl();
    void GpsDataCek();
    void YeniKonumHesapla(
        float latitude_in,     // mevcut (veya en son) GPS enlemi (derece)
        float longitude_in,    // mevcut (veya en son) GPS boylamı (derece)
        float heading_deg,     // yön (derece, 0 = kuzey, 90 = doğu)
        float sag_hiz,         // sağ teker hızı (m/s)
        float sol_hiz,         // sol teker hızı (m/s)
        float dt,              // zaman adımı (s) — 0.1
        bool gpsReset,         // GPS verisi yeni geldiyse true
        float* latitude_out,   // yeni enlem (derece)
        float* longitude_out   // yeni boylam (derece)
    );

private:
    UART_HandleTypeDef* huart_;
    lwgps_t gps_;
    uint8_t rxBuffer_u8[128];
    uint8_t rxIndex_u8;
    uint8_t rxData_u8;
    float latitude_f32;
    float longitude_f32;
};

#endif /* MYOTONOMDRIVERS_INC_GPS_H_ */
